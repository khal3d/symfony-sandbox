box: wercker/php
  
build:
    # The steps that will be executed on build
    steps:
      - koding/s3put@0.0.3
      # A custom script step, name value is used in the UI
      # and the code value contains the command that get executed
      - script:
          name: Set timezone
          code: |
            echo 'date.timezone = "Africa/Cairo"' >> $HOME/.phpenv/versions/$(phpenv version-name)/etc/php.ini
      - script:
          name: install dependencies
          code: composer install --no-interaction
      - script:
          name: echo php information
          code: |
            echo "php version $(php --version) running"
            echo "from location $(which php)"
      # - script:
      #     name: Install Nodejs Packages
      #     code: npm install
      # - plasticine/bower-install@0.0.4
      # - wercker/grunt@0.1.0

deploy:
    steps:
        - s3put:
            key-id:     $KEY
            key-secret: $SECRET
            file:       myproject-0.1.0.tar.gz
            url:        s3://mybucket/myproject-latest.tar.gz
